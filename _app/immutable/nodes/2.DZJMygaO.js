import{_ as Ot}from"../chunks/C1FmrZbK.js";import{s as Rt,d as C,x as Wt,y as Dt,z as xt,l as pt,A as nt,i as yt,m as s,B as H,b,C as jt,f as S,h as U,D as Ht,q as F,p as z,j as E,r as B,t as T,o as Pt,n as Ft,E as Bt,F as Tt,w as Ut}from"../chunks/CN3D1VmF.js";import{S as Yt,i as Xt,d as qt,t as Vt,a as Jt,m as Kt,c as Gt,b as Qt}from"../chunks/ClFM_-_F.js";import{e as Nt,c as Zt}from"../chunks/DIqvTF7t.js";import{P as $t}from"../chunks/B5-_xxuh.js";const te=!0,he=Object.freeze(Object.defineProperty({__proto__:null,prerender:te},Symbol.toStringTag,{value:"Module"}));function Ct(a,l,g){const c=a.slice();return c[39]=l[g],c}function It(a){let l,g=a[39]+"",c;return{c(){l=E("option"),c=T(g),this.h()},l(n){l=S(n,"OPTION",{});var p=U(l);c=z(p,g),p.forEach(C),this.h()},h(){l.__value=a[39],nt(l,l.__value)},m(n,p){yt(n,l,p),s(l,c)},p:Ft,d(n){n&&C(l)}}}function ee(a){let l,g,c="Load Satellites",n,p,W,v,Y,A,x,P,X,q,N,J,k,D,lt=a[2].radius+"",e,K,st,I,ot,O,gt,G,mt,_t,L,it,j,rt,ct,wt,Mt,Q,Z,bt,vt,$,tt,t,h,f,m,o,w,d,u,_,R,et,at=Nt(Object.keys(a[8])),y=[];for(let i=0;i<at.length;i+=1)y[i]=It(Ct(a,at,i));return u=new $t({props:{sketch:a[10]}}),{c(){l=E("div"),g=E("button"),g.textContent=c,n=B(),p=E("label"),W=T(`Export Format:
    `),v=E("select");for(let i=0;i<y.length;i+=1)y[i].c();Y=B(),A=E("button"),x=T("Export "),P=T(a[1]),X=T(" (A4 tiles)"),q=B(),N=E("label"),J=T(`FOV:
    `),k=E("input"),D=B(),e=T(lt),K=T("°"),st=B(),I=E("label"),ot=T(`Text Size:
    `),O=E("input"),gt=B(),G=T(a[6]),mt=T("px"),_t=B(),L=E("label"),it=T(`Circle Size:
    `),j=E("input"),rt=B(),ct=T(a[7]),wt=T("px"),Mt=B(),Q=E("label"),Z=E("input"),bt=T(" Show Satellite Names"),vt=B(),$=E("label"),tt=E("input"),t=T(" Show Satellite Circles"),h=B(),f=E("label"),m=E("input"),o=T(" Show Star Names"),w=B(),d=E("div"),Qt(u.$$.fragment),this.h()},l(i){l=S(i,"DIV",{class:!0});var r=U(l);g=S(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ht(g)!=="svelte-1cs6rue"&&(g.textContent=c),n=F(r),p=S(r,"LABEL",{class:!0});var M=U(p);W=z(M,`Export Format:
    `),v=S(M,"SELECT",{});var ht=U(v);for(let zt=0;zt<y.length;zt+=1)y[zt].l(ht);ht.forEach(C),M.forEach(C),Y=F(r),A=S(r,"BUTTON",{class:!0});var ut=U(A);x=z(ut,"Export "),P=z(ut,a[1]),X=z(ut," (A4 tiles)"),ut.forEach(C),q=F(r),N=S(r,"LABEL",{class:!0});var V=U(N);J=z(V,`FOV:
    `),k=S(V,"INPUT",{type:!0,min:!0,max:!0}),D=F(V),e=z(V,lt),K=z(V,"°"),V.forEach(C),st=F(r),I=S(r,"LABEL",{class:!0});var ft=U(I);ot=z(ft,`Text Size:
    `),O=S(ft,"INPUT",{type:!0,min:!0,max:!0}),gt=F(ft),G=z(ft,a[6]),mt=z(ft,"px"),ft.forEach(C),_t=F(r),L=S(r,"LABEL",{class:!0});var dt=U(L);it=z(dt,`Circle Size:
    `),j=S(dt,"INPUT",{type:!0,min:!0,max:!0}),rt=F(dt),ct=z(dt,a[7]),wt=z(dt,"px"),dt.forEach(C),Mt=F(r),Q=S(r,"LABEL",{class:!0});var St=U(Q);Z=S(St,"INPUT",{type:!0}),bt=z(St," Show Satellite Names"),St.forEach(C),vt=F(r),$=S(r,"LABEL",{class:!0});var Et=U($);tt=S(Et,"INPUT",{type:!0}),t=z(Et," Show Satellite Circles"),Et.forEach(C),h=F(r),f=S(r,"LABEL",{class:!0});var kt=U(f);m=S(kt,"INPUT",{type:!0}),o=z(kt," Show Star Names"),kt.forEach(C),r.forEach(C),w=F(i),d=S(i,"DIV",{class:!0});var At=U(d);Gt(u.$$.fragment,At),At.forEach(C),this.h()},h(){b(g,"class","svelte-pt3j1a"),a[1]===void 0&&jt(()=>a[12].call(v)),b(p,"class","svelte-pt3j1a"),b(A,"class","svelte-pt3j1a"),b(k,"type","range"),b(k,"min","10"),b(k,"max","180"),b(N,"class","svelte-pt3j1a"),b(O,"type","range"),b(O,"min","6"),b(O,"max","24"),b(I,"class","svelte-pt3j1a"),b(j,"type","range"),b(j,"min","1"),b(j,"max","20"),b(L,"class","svelte-pt3j1a"),b(Z,"type","checkbox"),b(Q,"class","svelte-pt3j1a"),b(tt,"type","checkbox"),b($,"class","svelte-pt3j1a"),b(m,"type","checkbox"),b(f,"class","svelte-pt3j1a"),b(l,"class","controls svelte-pt3j1a"),b(d,"class","viz-container svelte-pt3j1a")},m(i,r){yt(i,l,r),s(l,g),s(l,n),s(l,p),s(p,W),s(p,v);for(let M=0;M<y.length;M+=1)y[M]&&y[M].m(v,null);xt(v,a[1],!0),s(l,Y),s(l,A),s(A,x),s(A,P),s(A,X),s(l,q),s(l,N),s(N,J),s(N,k),nt(k,a[2].radius),s(N,D),s(N,e),s(N,K),s(l,st),s(l,I),s(I,ot),s(I,O),nt(O,a[6]),s(I,gt),s(I,G),s(I,mt),s(l,_t),s(l,L),s(L,it),s(L,j),nt(j,a[7]),s(L,rt),s(L,ct),s(L,wt),s(l,Mt),s(l,Q),s(Q,Z),Z.checked=a[3],s(Q,bt),s(l,vt),s(l,$),s($,tt),tt.checked=a[4],s($,t),s(l,h),s(l,f),s(f,m),m.checked=a[5],s(f,o),yt(i,w,r),yt(i,d,r),Kt(u,d,null),a[20](d),_=!0,R||(et=[H(g,"click",a[9]),H(v,"change",a[12]),H(A,"click",a[13]),H(k,"change",a[14]),H(k,"input",a[14]),H(O,"change",a[15]),H(O,"input",a[15]),H(j,"change",a[16]),H(j,"input",a[16]),H(Z,"change",a[17]),H(tt,"change",a[18]),H(m,"change",a[19])],R=!0)},p(i,r){if(r[0]&256){at=Nt(Object.keys(i[8]));let M;for(M=0;M<at.length;M+=1){const ht=Ct(i,at,M);y[M]?y[M].p(ht,r):(y[M]=It(ht),y[M].c(),y[M].m(v,null))}for(;M<y.length;M+=1)y[M].d(1);y.length=at.length}r[0]&258&&xt(v,i[1]),(!_||r[0]&2)&&pt(P,i[1]),r[0]&4&&nt(k,i[2].radius),(!_||r[0]&4)&&lt!==(lt=i[2].radius+"")&&pt(e,lt),r[0]&64&&nt(O,i[6]),(!_||r[0]&64)&&pt(G,i[6]),r[0]&128&&nt(j,i[7]),(!_||r[0]&128)&&pt(ct,i[7]),r[0]&8&&(Z.checked=i[3]),r[0]&16&&(tt.checked=i[4]),r[0]&32&&(m.checked=i[5])},i(i){_||(Jt(u.$$.fragment,i),_=!0)},o(i){Vt(u.$$.fragment,i),_=!1},d(i){i&&(C(l),C(w),C(d)),Wt(y,i),qt(u),a[20](null),R=!1,Dt(et)}}}const ae=100;function le(a,l,g=new Date){const c=l.lon/15;let W=18.697374558+24.06570982441908*(g/864e5+24405875e-1-2451545);W=W%24;const v=(W+c)%24,Y=parseFloat(a.ra),x=(v-Y)*15%360*Math.PI/180,P=parseFloat(a.dec)*Math.PI/180,X=l.lat*Math.PI/180,q=Math.sin(P)*Math.sin(X)+Math.cos(P)*Math.cos(X)*Math.cos(x),N=Math.asin(q)*180/Math.PI,J=(Math.sin(P)-Math.sin(N*Math.PI/180)*Math.sin(X))/(Math.cos(N*Math.PI/180)*Math.cos(X));let k=Math.acos(J)*180/Math.PI;return Math.sin(x)>0&&(k=360-k),{alt:N,az:k}}function Lt(a,l){const g=l.lat*Math.PI/180,c=a.lat*Math.PI/180,n=(a.lon-l.lon)*Math.PI/180,p=Math.sin(n)*Math.cos(c),W=Math.cos(g)*Math.sin(c)-Math.sin(g)*Math.cos(c)*Math.cos(n);let v=Math.atan2(p,W)*180/Math.PI;return v=(v+360)%360,{alt:90-Math.acos(Math.sin(g)*Math.sin(c)+Math.cos(g)*Math.cos(c)*Math.cos(n))*180/Math.PI,az:v}}function se(a,l,g){let c={lat:52.52,lon:13.405,alt:0,radius:18,satid:52},n,p=[],W=[],v=!0,Y=!0,A=!0,x=6,P=8,X=[0,0,0,70],q=[0,0,0];const N=[],J={A4:[2480,3508],A3:[3508,4960],A2:[4960,7016],A1:[7016,9933],A0:[9933,14043]},k={A4:[1,1],A3:[1,2],A2:[2,2],A1:[2,4],A0:[4,4]};let D="A3";const lt=[{label:"N",az:0},{label:"E",az:90},{label:"S",az:180},{label:"W",az:270}];let e={x:0,y:0,w:0,h:0,scale:1,dragging:!1,dragOffsetX:0,dragOffsetY:0};function K(){if(typeof window>"u"||!n)return;const[t,h]=J[D],f=n.offsetWidth,m=n.offsetHeight,o=Math.min(.9,f/t,m/h);e.w=t*o,e.h=h*o,e.scale=o,e.x=(f-e.w)/2,e.y=(m-e.h)/2}Pt(()=>{K(),window.addEventListener("resize",K)});let st=null,I=null,ot=!1,O=!1;function gt(t,h,f=new Date){if(ot&&st&&I){const m=I(h.lat,h.lon,h.alt||0),o=st(f,m,parseFloat(t.ra),parseFloat(t.dec),"normal");return{alt:o.altitude,az:o.azimuth}}else return le(t,h,f)}function G(t,h,f,m,o=c.radius){const w=(90-t)/o*(Math.min(f,m)/2),d=(h-90)*(Math.PI/180),u=f/2+w*Math.cos(d),_=m/2+w*Math.sin(d);return{x:u,y:_}}async function mt(){return new Promise(t=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(h=>{g(2,c.lat=h.coords.latitude,c),g(2,c.lon=h.coords.longitude,c),t()},()=>t()):t()})}async function _t(){await mt(),p=[];const t=`https://api.n2yo.com/rest/v1/satellite/above/${c.lat}/${c.lon}/${c.alt}/${ae}/${c.satid}/?apiKey=DDSWUW-YEQB3S-EEJPFN-45Y0`;try{const f=await(await fetch(t)).json();if(!f.above)return;p=f.above.map(m=>({name:m.satname.replace("STARLINK-","").replace("STARLINK ",""),lat:m.satlat,lon:m.satlng}))}catch(h){console.error(h)}}Pt(async()=>{await Zt("/hyglike_from_athyg_v32.csv").then(t=>{W=t.filter(h=>h.mag!==void 0&&!isNaN(+h.mag)&&+h.mag<6),O=!0}),Ot(()=>import("../chunks/IZ2Xtl_n.js"),[],import.meta.url).then(t=>{st=t.EquatorialToHorizontal,I=t.MakeObserver,ot=!0})});let L=[];function it(t,h,f,m,o=10){let w=0,d=0;f.measureText?(w=f.measureText(m).width,d=x*4):f.textWidth&&(w=f.textWidth(m),d=x*4);const u={x:t-w/2,y:h-d,w,h:d+o};for(const _ of L)if(u.x<_.x+_.w&&u.x+u.w>_.x&&u.y<_.y+_.h&&u.y+u.h>_.y)return!0;return L.push(u),!1}let j=t=>{t.setup=()=>{let h=5;n!=null&&n.offsetWidth||window.innerWidth,n!=null&&n.offsetHeight||window.innerHeight,t.createCanvas((n==null?void 0:n.offsetWidth)||window.innerWidth,(n==null?void 0:n.offsetHeight)||window.innerHeight),t.pixelDensity(h)},t.draw=()=>{if(!O){t.background("white"),t.fill(0),t.textAlign(t.CENTER,t.CENTER),t.textSize(22),t.text("Loading stars...",t.width/2,t.height/2);return}t.background("white"),L=[];const h=new Date;t.noStroke(),t.textSize(x),t.textAlign(t.CENTER,t.CENTER);for(const o of W){const{alt:w,az:d}=gt(o,c,h);if(w>0){const{x:u,y:_}=G(w,d,t.width,t.height,c.radius);t.fill(X);const R=Math.max(2,3-o.mag);if(t.ellipse(u,_,R,R),A&&o.proper&&!it(u,_,t,o.proper,R*1.2)){t.textSize(x),t.fill(X),t.stroke("white"),t.strokeWeight(2);const et=o.proper||o.hip||o.id;t.text(et,u,_-R-2),t.noStroke(),t.strokeWeight(1),t.textSize(x)}}}t.fill(q),t.textSize(12);for(const o of N){if(Math.abs(o.lat-c.lat)<.1&&Math.abs(o.lon-c.lon)<.1)continue;const{alt:w,az:d}=Lt(o,c),{x:u,y:_}=G(w,d,t.width,t.height,c.radius);t.ellipse(u,_,12,12),t.textAlign(t.CENTER,t.TOP),t.text(o.name,u,_+8)}t.fill(q),t.textSize(24),t.textAlign(t.CENTER,t.CENTER);for(const o of lt){const{x:w,y:d}=G(0,o.az,t.width,t.height,c.radius);t.text(o.label,w,d-18)}if(p.length>0){t.fill(q),t.textSize(x);for(const o of p){const{alt:w,az:d}=Lt(o,c);if(w>0){const{x:u,y:_}=G(w,d,t.width,t.height,c.radius);Y&&t.ellipse(u,_,P,P),v&&!it(u,_,t,o.name,P)&&(t.fill([...q,90]),t.stroke("white"),t.strokeWeight(2),t.text(o.name,u,_-P-1),t.noStroke(),t.strokeWeight(1),t.fill(q))}}}t.push(),t.noFill(),t.stroke(0,80),t.strokeWeight(.5),t.rect(e.x,e.y,e.w,e.h);const[f,m]=k[D];if(f>1||m>1){const o=e.w/f,w=e.h/m;for(let d=1;d<f;d++){let u=e.x+d*o;t.line(u,e.y,u,e.y+e.h)}for(let d=1;d<m;d++){let u=e.y+d*w;t.line(e.x,u,e.x+e.w,u)}}t.pop()},t.mousePressed=()=>{t.mouseX>e.x&&t.mouseX<e.x+e.w&&t.mouseY>e.y&&t.mouseY<e.y+e.h&&(e.dragging=!0,e.dragOffsetX=t.mouseX-e.x,e.dragOffsetY=t.mouseY-e.y)},t.mouseReleased=()=>{e.dragging=!1},t.mouseDragged=()=>{e.dragging&&(e.x=Math.max(0,Math.min(t.mouseX-e.dragOffsetX,t.width-e.w)),e.y=Math.max(0,Math.min(t.mouseY-e.dragOffsetY,t.height-e.h)))},t.windowResized=()=>{let h=5,f=(n==null?void 0:n.offsetWidth)||window.innerWidth,m=(n==null?void 0:n.offsetHeight)||window.innerHeight;t.resizeCanvas(f*h,m*h),t.pixelDensity(h),K()}};function rt(t=D){const[h,f]=k[t],m=n.querySelector("canvas");if(!m)return;let o=5;const w=e.w*o,d=e.h*o,u=w/h,_=d/f;for(let R=0;R<f;R++)for(let et=0;et<h;et++){const at=Math.round((e.x+et*(e.w/h))*o),y=Math.round((e.y+R*(e.h/f))*o),i=Math.round(u),r=Math.round(_),M=document.createElement("canvas");M.width=i,M.height=r,M.getContext("2d").drawImage(m,at,y,i,r,0,0,i,r);const ut=M.toDataURL("image/png"),V=document.createElement("a");V.href=ut,V.download=`${t}_tile_row-${R+1}_col-${et+1}.png`,V.click()}}function ct(){D=Bt(this),g(1,D),g(8,J)}const wt=()=>rt(D);function Mt(){c.radius=Tt(this.value),g(2,c)}function Q(){x=Tt(this.value),g(6,x)}function Z(){P=Tt(this.value),g(7,P)}function bt(){v=this.checked,g(3,v)}function vt(){Y=this.checked,g(4,Y)}function $(){A=this.checked,g(5,A)}function tt(t){Ut[t?"unshift":"push"](()=>{n=t,g(0,n)})}return a.$$.update=()=>{a.$$.dirty[0]&2&&D&&K(),a.$$.dirty[0]&1&&n&&K()},[n,D,c,v,Y,A,x,P,J,_t,j,rt,ct,wt,Mt,Q,Z,bt,vt,$,tt]}class ue extends Yt{constructor(l){super(),Xt(this,l,se,ee,Rt,{},null,[-1,-1])}}export{ue as component,he as universal};
