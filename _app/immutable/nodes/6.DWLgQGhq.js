import{s as H,n as V,d as k,y as W,i as C,m as I,B,b as G,f as w,h as N,q as O,D as A,j as E,r as X,w as J}from"../chunks/CN3D1VmF.js";import{S as K,i as Q,d as Z,t as ee,a as te,m as ne,c as se,b as ae}from"../chunks/ClFM_-_F.js";import{P as oe}from"../chunks/B5-_xxuh.js";function ie(m){let s,u,h,a,x="Export G-code",d,i,l,v,_,e;return l=new oe({props:{sketch:m[3]}}),{c(){s=E("div"),u=E("input"),h=X(),a=E("button"),a.textContent=x,d=X(),i=E("div"),ae(l.$$.fragment),this.h()},l(t){s=w(t,"DIV",{class:!0});var n=N(s);u=w(n,"INPUT",{type:!0,accept:!0}),h=O(n),a=w(n,"BUTTON",{"data-svelte-h":!0}),A(a)!=="svelte-uu031e"&&(a.textContent=x),n.forEach(k),d=O(t),i=w(t,"DIV",{class:!0});var r=N(i);se(l.$$.fragment,r),r.forEach(k),this.h()},h(){G(u,"type","file"),G(u,"accept",".geojson,.json"),G(s,"class","controls svelte-1d2t3ja"),G(i,"class","viz-container svelte-1d2t3ja")},m(t,n){C(t,s,n),I(s,u),I(s,h),I(s,a),C(t,d,n),C(t,i,n),ne(l,i,null),m[4](i),v=!0,_||(e=[B(u,"change",m[1]),B(a,"click",m[2])],_=!0)},p:V,i(t){v||(te(l.$$.fragment,t),v=!0)},o(t){ee(l.$$.fragment,t),v=!1},d(t){t&&(k(s),k(d),k(i)),Z(l),m[4](null),_=!1,W(e)}}}const D=148,L=210,S=10;function re(m,s,u){let h=null,a=[],x="",d;function i(e){const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=r=>{h=JSON.parse(r.target.result);let c=1/0,o=-1/0,$=1/0,f=-1/0;h.features.forEach(b=>{b.geometry.coordinates.forEach(([g,M])=>{c=Math.min(c,g),o=Math.max(o,g),$=Math.min($,M),f=Math.max(f,M)})});const p=D-2*S,F=L-2*S,y=o-c,P=f-$,j=p/y,Y=F/P,T=new Set;a=[],h.features.forEach(b=>{var U,R;const g=((U=b.properties)==null?void 0:U.id)||((R=b.properties)==null?void 0:R.name);if(!g||T.has(g))return;T.add(g);const M=b.geometry.coordinates.map(([q,z])=>({x:S+(q-c)*j,y:S+(f-z)*Y}));a.push({id:g,path:M})})},n.readAsText(t)}function l(){const r="M5",c="M3 S1000";let o=["G21         ; units = mm","G90         ; absolute positioning",r,`G4 P${.2} ; initial pause`];a.forEach(({path:p})=>{if(!p||p.length<2)return;const F=p[0];o.push(`G4 P${.2} ; pause before travel`,`G0 X${F.x.toFixed(3)} Y${F.y.toFixed(3)} F10000`),o.push(`G4 P${.2}`,c,`G4 P${.2}`);for(let y=1;y<p.length;y++){const{x:P,y:j}=p[y];o.push(`G1 X${P.toFixed(3)} Y${j.toFixed(3)} F3500`)}o.push(r,`G4 P${.2}`)}),x=o.join(`
`);const $=new Blob([x],{type:"text/plain"}),f=document.createElement("a");f.href=URL.createObjectURL($),f.download="satellite_paths.gcode",f.click()}let v=e=>{e.setup=()=>{e.createCanvas(D,L),e.background(255),e.stroke(0),e.noFill()},e.draw=()=>{e.clear(),e.background(255),e.stroke(150),e.noFill(),e.rect(0,0,D,L),a.forEach(({id:t,path:n})=>{if(!n||n.length===0)return;e.beginShape(),n.forEach(o=>e.vertex(o.x,o.y)),e.endShape();const r=n[0];e.fill(0),e.noStroke(),e.textSize(8),e.text(t,r.x+2,r.y-2),e.noFill(),e.stroke(0);const c=n[n.length-1];e.fill(255,0,0),e.noStroke(),e.ellipse(c.x,c.y,4,4),e.noFill(),e.stroke(0)})}};function _(e){J[e?"unshift":"push"](()=>{d=e,u(0,d)})}return[d,i,l,v,_]}class de extends K{constructor(s){super(),Q(this,s,re,ie,H,{})}}export{de as component};
